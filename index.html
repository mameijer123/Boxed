<!DOCTYPE html>
<html>
  <head>
    <title>BoxedIn Settings</title>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <link rel="stylesheet" href="http://code.jquery.com/mobile/1.4.1/jquery.mobile-1.4.1.min.css" />
    <script src="http://code.jquery.com/jquery-2.1.0.min.js"></script>
    <script src="http://code.jquery.com/mobile/1.4.1/jquery.mobile-1.4.1.min.js"></script>
  </head>
  <body>
    <div data-role="page" id="main">
      <div data-role="header" class="jqm-header">
        <h1>BoxedIn Settings</h1>
      </div>

      <div data-role="content">

<div data-role="collapsible-set" data-theme="c" data-content-theme="d" data-mini="false">
    <div data-role="collapsible">
        <h3>Color</h3>

<fieldset data-role="controlgroup" data-type="vertical" data-mini="true">
    <legend>Font Color</legend>
        <input name="key0" id="key0-0" data-type="text" value="0xFFFFFF" checked="checked" type="radio">
        <label for="key0-0">White</label>
        <input name="key0" id="key0-1" data-type="text" value="0xFF0000" checked="checked" type="radio">
        <label for="key0-1">Red</label>
        <input name="key0" id="key0-2" data-type="text" value="0x0000FF" checked="checked" type="radio">
        <label for="key0-2">Blue</label>
        <input name="key0" id="key0-3" data-type="text" value="0x00FF00" checked="checked" type="radio">
        <label for="key0-3">Green</label>
        <input name="key0" id="key0-4" data-type="text" value="0xFFFF00" checked="checked" type="radio">
        <label for="key0-4">Yellow</label>
        <input name="key0" id="key0-5" data-type="text" value="0xAA00AA" checked="checked" type="radio">
        <label for="key0-5">Purple</label>
</fieldset>



</div>

<div>
  <input id='twentyfour' type='checkbox'>
  Enable Second Ticks
</input>

</div>

<input id='submit_button' type='button' value='Save'>

<script>
  // Get a handle to the button's HTML element
  var submitButton = document.getElementById('submit_button');

  // Add a 'click' listener
  submitButton.addEventListener('click', function() {
    
    console.log('Got here');
    // Get the config data from the UI elements
    var backgroundColor;
    //var foregroundColor = document.getElementById('foreground_color_input');
    var twentyfour = document.getElementsByName('key1');
    if (document.getElementById('key0-0').checked = true) {
      backgroundColor = document.getElementById('key0-0');
    } else if (document.getElementById('key0-1').checked = true) {
      backgroundColor = document.getElementById('key0-1');
    } else if (document.getElementById('key0-2').checked = true) {
      backgroundColor = document.getElementById('key0-2');
    } else if (document.getElementById('key0-3').checked = true) {
      backgroundColor = document.getElementById('key0-3');
    } else if (document.getElementById('key0-4').checked = true) {
      backgroundColor = document.getElementById('key0-4');
    } else if (document.getElementById('key0-5').checked = true) {
      backgroundColor = document.getElementById('key0-5');
    }

    // Make a data object to be sent, coercing value types to integers
    var options = {
      'background_color': parseInt(backgroundColor.value, 16),
      //'foreground_color': parseInt(foregroundColor.value, 16),
      'twentyfour': twentyfour.checked == 'true' ? 1 : 0,
    };

    // Determine the correct return URL (emulator vs real watch)
    function getQueryParam(variable, defaultValue) {
      var query = location.search.substring(1);
      var vars = query.split('&');
      for (var i = 0; i < vars.length; i++) {
        var pair = vars[i].split('=');
        if (pair[0] === variable) {
          return decodeURIComponent(pair[1]);
        }
      }
      return defaultValue || false;
    }
    var return_to = getQueryParam('return_to', 'pebblejs://close#');

    // Encode and send the data when the page closes
    document.location = return_to + encodeURIComponent(JSON.stringify(options));
  });
</script>

  </body>
</html>
